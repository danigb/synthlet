(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[88],{7908:function(e,t,r){Promise.resolve().then(r.t.bind(r,231,23)),Promise.resolve().then(r.bind(r,7423))},7423:function(e,t,r){"use strict";r.d(t,{FlyMono:function(){return T}});var a,s,o,n,i,l=r(7437),u=["gate","attack","decay","sustain","release","offset","gain"],c=["waveform","frequency"];function h(e){return"sine"===e?0:"sawtooth"===e?1:"square"===e?2:"triangle"===e?3:void 0}function p(e,t,r){if(!t.has(e))throw TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function f(e,t){var r=p(e,t,"get");return r.get?r.get.call(e):r.value}function d(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function m(e,t,r){d(e,t),t.set(e,r)}function b(e,t,r){var a=p(e,t,"set");return!function(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw TypeError("attempted to set read only private field");t.value=r}}(e,a,r),r}async function y(){let e=await fetch(this.url);if(!e.ok)throw Error("Failed to load ".concat(this.url));let t=await e.arrayBuffer(),r=i.decodeWavetable(t);return b(this,a,r.sampleRate),b(this,s,r.data),{data:f(this,s),length:this.wavetableLength,sampleRate:f(this,a)}}a=new WeakMap,s=new WeakMap,o=new WeakMap,n=new WeakSet,i=class{static async fetchAvailableNames(){let e=await fetch("https://smpldsnds.github.io/wavedit-online/samples/files.json");if(!e.ok)throw Error("Failed to load wavetable list.");return await e.json()}onLoad(){return f(this,o)}getData(){return f(this,s)}static decodeWavetable(e){let t=new DataView(e),r=t.getUint16(20,!0),a=t.getUint32(24,!0),s=t.getUint16(22,!0),o=t.getUint16(34,!0),n=t.getUint32(40,!0);if(1!==r)throw Error("Invalid format. Only PCM supported.");if(1!==s)throw Error("Invalid format. Only mono supported.");let i=32===o,l=o/8,u=n/(l*s),c=new Float32Array(u);for(let e=0;e<u;e++)for(let r=0;r<s;r++){let a=44+(e*s+r)*l;c[e]=i?t.getFloat32(a,!0):t.getInt16(a,!0)/32768}return{sampleRate:a,data:c}}constructor(e,t){d(this,n),n.add(this),m(this,a,{writable:!0,value:void 0}),m(this,s,{writable:!0,value:void 0}),m(this,o,{writable:!0,value:void 0}),this.url=e,this.wavetableLength=t,b(this,o,(function(e,t,r){if(!t.has(e))throw TypeError("attempted to get private field on non-instance");return r})(this,n,y).call(this))}};var g=["filterType","frequency","resonance"];function v(e){return"lowpass"===e?1:"bandpass"===e?2:"highpass"===e?3:0}async function k(){console.log("CREATE CONTEXT");let e=new AudioContext;return console.log("REGISTERED"),await Promise.all([function(e){if(!(e.audioWorklet&&"function"==typeof e.audioWorklet.addModule))throw Error("AudioWorklet not supported");return e.audioWorklet.__SYNTHLET_ADSR_REGISTERED__?Promise.resolve():(e.audioWorklet.__SYNTHLET_ADSR_REGISTERED__=!0,e.audioWorklet.addModule(function(){let e=new Blob(['"use strict";(()=>{function C(){let i=!1;return a=>{if(i===!1&&a>=.9)return i=!0,!0;if(i===!0&&a<.1)return i=!1,!1}}function x(i){let a=Math.exp(-1.5),c=Math.exp(-4.95),u=0,n=0,l=0,f=0,h=0,y=1,g={b:0,c:0},m={b:0,c:0},p={b:0,c:0},D=C(),b=0,t=0;return F(.01,.1,.5,.3),{agen:k,amod:P};function P(e,r,o){k(r,o);for(let s=0;s<r.length;s++)r[s]*=e[s]}function k(e,r){R(r);for(let o=0;o<e.length;o++){switch(b){case 1:t=g.b+t*g.c,(t>=1||u<=0)&&(t=1,b=2);break;case 2:t=m.b+t*m.c,(t<=f||n<=0)&&(t=f,b=3);break;case 3:t=f;break;case 4:t=p.b+t*p.c,(t<=0||l<=0)&&(t=0,b=0)}e[o]=t*y+h}}function R(e){let r=D(e.gate[0]);r===!0?b=1:r===!1&&(b=4),F(e.attack[0],e.decay[0],e.sustain[0],e.release[0]),h=e.offset[0],y=e.gain[0]}function F(e,r,o,s){f!==o&&(f=o,n=r,d(m,n,f,c)),u!==e&&(u=e,d(g,u,1+2*a,a)),n!==r&&(n=r,d(m,n,f,c)),l!==s&&(l=s,d(p,l,0,c))}function d(e,r,o,s){let $=r*i;e.c=Math.exp(-Math.log((1+s)/s)/$),e.b=(o-s)*(1-e.c)}}var A=class extends AudioWorkletProcessor{p;g;r=!0;constructor(a){super(),this.g=a?.processorOptions?.mode!=="modulator",this.p=x(sampleRate),this.port.onmessage=c=>{switch(c.data.type){case"DISCONNECT":this.r=!1;break}}}process(a,c,u){let n=c[0][0],l=a[0][0];return this.g?this.p.agen(n,u):l&&this.p.amod(l,n,u),this.r}static get parameterDescriptors(){return[["gate",0,0,1],["attack",.01,0,1],["decay",.1,0,1],["sustain",.5,0,1],["release",.3,0,1],["offset",0,0,2e4],["gain",1,-2e4,2e4]].map(([a,c,u,n])=>({name:a,defaultValue:c,minValue:u,maxValue:n,automationRate:"k-rate"}))}};registerProcessor("AdsrWorkletProcessor",A);})();'],{type:"application/javascript"});return URL.createObjectURL(e)}()))}(e),function(e){if(!(e.audioWorklet&&"function"==typeof e.audioWorklet.addModule))throw Error("AudioWorklet not supported");return e.audioWorklet.__SYNTHLET_NOISE_REGISTERED__?Promise.resolve():(e.audioWorklet.__SYNTHLET_NOISE_REGISTERED__=!0,e.audioWorklet.addModule(function(){let e=new Blob(['"use strict";(()=>{var e=class extends AudioWorkletProcessor{static parameterDescriptors=[];r;constructor(){super(),this.r=!0,this.port.onmessage=s=>{switch(s.data.type){case"DISCONNECT":this.r=!1;break}}}process(s,t,o){for(let r=0;r<t[0][0].length;r++)t[0][0][r]=Math.random()*2-1;return this.r}};registerProcessor("NoiseWorkletProcessor",e);})();'],{type:"application/javascript"});return URL.createObjectURL(e)}()))}(e),function(e){if(!(e.audioWorklet&&"function"==typeof e.audioWorklet.addModule))throw Error("AudioWorklet not supported");return e.audioWorklet.__SYNTHLET_POLYBLEP_REGISTERED__?Promise.resolve():(e.audioWorklet.__SYNTHLET_POLYBLEP_REGISTERED__=!0,e.audioWorklet.addModule(function(){let e=new Blob(['"use strict";(()=>{var r=class{onedsr;freq;phs;inc;prev;R;x;y;constructor(t){this.onedsr=1/t,this.freq=0,this.phs=0,this.inc=0,this.prev=0,this.R=Math.exp(-1/(.0025*t)),this.x=0,this.y=0}setFreq(t){this.freq!==t&&(this.freq=t,this.inc=t*this.onedsr)}sine(){let t=Math.sin(this.phs);return this.phs+=this.inc,this.phs>1&&(this.phs-=1),t}saw(){let t=m(this.phs,this.inc);return this.phs+=this.inc,this.phs>1&&(this.phs-=1),t}square(){let t=p(this.phs,this.inc);return this.phs+=this.inc,this.phs>1&&(this.phs-=1),t}triangle(){let t=p(this.phs,this.inc);t*=4/this.freq,t+=this.prev,this.prev=t,this.y=t-this.x+this.R*this.y,this.x=t;let i=this.y*.8;return this.phs+=this.inc,this.phs>1&&(this.phs-=1),i}};function h(s,t){if(s<t){let i=s/t;return i+i-i*i-1}else if(s>1-t){let i=(s-1)/t;return i+i+i*i+1}else return 0}function p(s,t){return(s<.5?-1:1)-h(s,t)+h((s+.5)%1,t)}function m(s,t){return s*2-1-h(s,t)}var n=class extends AudioWorkletProcessor{static parameterDescriptors=[{name:"waveform",defaultValue:1,minValue:0,maxValue:3,automationRate:"k-rate"},{name:"frequency",defaultValue:1e3,minValue:16,maxValue:2e4,automationRate:"k-rate"}];r;p;w;constructor(){super(),this.r=!0,this.p=new r(sampleRate),this.w=[this.p.sine.bind(this.p),this.p.saw.bind(this.p),this.p.square.bind(this.p),this.p.triangle.bind(this.p)],this.port.onmessage=t=>{switch(t.data.type){case"DISCONNECT":this.r=!1;break}}}process(t,i,o){let a=o.frequency[0],l=o.waveform[0],c=this.w[l];this.p.setFreq(a);let u=i[0][0];for(let e=0;e<u.length;e++)u[e]=c();return this.r}};registerProcessor("PolyBLEPWorkletProcessor",n);})();'],{type:"application/javascript"});return URL.createObjectURL(e)}()))}(e),function(e){if(!(e.audioWorklet&&"function"==typeof e.audioWorklet.addModule))throw Error("AudioWorklet not supported");return e.audioWorklet.__SYNTHLET_ADSR_REGISTERED__?Promise.resolve():(e.audioWorklet.__SYNTHLET_ADSR_REGISTERED__=!0,e.audioWorklet.addModule(function(){let e=new Blob(['"use strict";(()=>{function x(n,e,r){return Math.max(e,Math.min(r,n))}function V(n){let e=1e3,r=.5,o=1,s=.5/n,c=2*Math.PI,b=0,t=0,P=0,m=0,p=0,f=0,u=0,h=0;function g(a){if(o=a.filterType[0],a.frequency[0]!==e||a.resonance[0]!==r){e=a.frequency[0],r=a.resonance[0];let y=x(e,16,n/2),i=1/x(r,.025,40);t=2*n*Math.tan(c*s*y)*s,b=1/(1+i*t+t*t),P=t+i}}function k(a,y){for(let l=0;l<a.length;l++){let i=a[l];f=(i-P*m-p)*b,u=t*f+m,h=t*u+p,m=t*f+u,p=t*u+h,y[l]=o===1?h:o===3?f:o===2?u:i}}return{update:g,fill:k}}var d=class extends AudioWorkletProcessor{static parameterDescriptors=[{name:"filterType",defaultValue:1,minValue:0,maxValue:3,automationRate:"k-rate"},{name:"frequency",defaultValue:1e3,minValue:16,maxValue:2e4,automationRate:"k-rate"},{name:"resonance",defaultValue:.5,minValue:0,maxValue:40,automationRate:"k-rate"}];f;r;constructor(){super(),this.f=V(sampleRate),this.r=!0,this.port.onmessage=e=>{switch(e.data.type){case"STOP":this.r=!1;break}}}process(e,r,o){let s=e[0][0],c=r[0][0];return this.f.update(o),s&&c&&this.f.fill(s,c),this.r}};registerProcessor("StateVariableFilterWorkletProcessor",d);})();'],{type:"application/javascript"});return URL.createObjectURL(e)}()))}(e),function(e){if(!(e.audioWorklet&&"function"==typeof e.audioWorklet.addModule))throw Error("AudioWorklet not supported");return e.audioWorklet.__SYNTHLET_ADSR_REGISTERED__?Promise.resolve():(e.audioWorklet.__SYNTHLET_ADSR_REGISTERED__=!0,e.audioWorklet.addModule(function(){let e=new Blob(['"use strict";(()=>{function F(l){let e=220,r=440,a=.005,o=new Float32Array(0),n=0,i=0,s=0,u=0,c=0,b=2,q=W(l),d=w();function A(t){(t.frequency[0]!==r||t.baseFrequency[0]!==e)&&(e=t.baseFrequency[0],r=t.frequency[0],b=r/e),a=t.morphFrequency[0]}function V(t,m){o=t,n=Math.min(m,t.length),i=Math.floor(t.length/n),s=0,u=(s+1)%i}function x(t,m){if(n===0||i===0){t.fill(0);return}A(m);for(let f=0;f<t.length;f++){let h=q(a),p=g(o,n,s,c);if(u!==s){let k=g(o,n,u,c);t[f]=(1-h)*p+h*k}else t[f]=p;c+=b,c>=n&&(c-=n),c<0&&(c+=n),d(h)&&(s=u,u=(u+1)%i)}}return{agen:x,set:V}}function g(l,e,r,a){let o=Math.floor(a),n=a-o,i=(o+1)%e,s=l[r*e+o],u=l[r*e+i];return s+(u-s)*n}function W(l){let e=1/l,r=0;return a=>{for(r+=a*e;r>=1;)r-=1;for(;r<0;)r+=1;return r}}function w(){let l=0,e=!1;return function(a){let n=Math.abs(a-l)>.5;return l=a,a===0||e===!0?(e=!1,!1):(e=n,n)}}var y=class extends AudioWorkletProcessor{static parameterDescriptors=[{name:"baseFrequency",defaultValue:220,minValue:0,maxValue:2e4,automationRate:"k-rate"},{name:"frequency",defaultValue:440,minValue:0,maxValue:2e4,automationRate:"k-rate"},{name:"morphFrequency",defaultValue:.05,minValue:0,maxValue:10,automationRate:"k-rate"}];u;r;constructor(){super(),this.u=F(sampleRate),this.r=!0,this.port.onmessage=e=>{switch(e.data.type){case"WAVETABLE":this.u.set(e.data.wavetable,e.data.wavetableLength);break;case"DISCONNECT":this.r=!1;break}}}process(e,r,a){return this.u.agen(r[0][0],a),this.r}};registerProcessor("WavetableWorkletProcessor",y);})();'],{type:"application/javascript"});return URL.createObjectURL(e)}()))}(e)]).then(()=>{}),e}var w=r(2265);function E(e){let{label:t,min:r,max:a,initial:s,onChange:o,step:n=1,transform:i=e=>e,inputClassName:u,labelClassName:c,valueClassName:h}=e,[p,f]=(0,w.useState)(i(s));return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("p",{className:c,children:t}),(0,l.jsx)("input",{className:u,type:"range",min:r,max:a,step:n,value:p,onChange:e=>{let t=i(e.target.valueAsNumber);f(t),o(t)}}),(0,l.jsx)("p",{className:h,children:p.toFixed(2)})]})}function x(e){return 440*Math.pow(2,(e-69)/12)}function T(){let[e,t]=(0,w.useState)(null);return(0,w.useEffect)(()=>{k().then(e=>{t(new _(e))})},[]),e?(0,l.jsxs)("div",{className:"flex flex-col bg-blue-600 p-4 rounded border border-blue-500",children:[(0,l.jsx)("h1",{className:"text-xl border-b border-blue-400",children:"Fly Monophonic Synthesizer"}),(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsx)("h2",{className:"border-b border-blue-400",children:"Filter"}),(0,l.jsx)("div",{className:"mt-2 grid grid-cols-4 gap-2 w-[30rem]",children:(0,l.jsx)(E,{label:"frequency",labelClassName:"text-right",inputClassName:"col-span-2",min:0,max:127,step:.1,initial:69,transform:x,onChange:()=>{}})})]}),(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsx)("h2",{className:"border-b border-blue-400",children:"Amplifier"}),(0,l.jsxs)("div",{className:"mt-2 grid grid-cols-4 gap-2 w-[30rem]",children:[(0,l.jsx)(E,{label:"attack",labelClassName:"text-right",inputClassName:"col-span-2",min:.1,max:10,step:.1,initial:.2,onChange:()=>{}}),(0,l.jsx)(E,{label:"decay",labelClassName:"text-right",inputClassName:"col-span-2",min:.1,max:10,step:.1,initial:.2,onChange:()=>{}}),(0,l.jsx)(E,{label:"sustain",labelClassName:"text-right",inputClassName:"col-span-2",min:.1,max:1,step:.01,initial:.8,onChange:()=>{}}),(0,l.jsx)(E,{label:"release",labelClassName:"text-right",inputClassName:"col-span-2",min:.1,max:100,step:.2,initial:.2,onChange:()=>{}})]})]}),(0,l.jsx)("div",{className:"mt-4",children:(0,l.jsx)("button",{className:"border border-white px-1 rounded opacity-70 hover:opacity-80",onMouseDown:()=>{e.vca.gateOn()},onMouseUp:()=>{e.vca.gateOff()},onMouseLeave:()=>{e.vca.gateOff()},children:"Gate"})})]}):(0,l.jsx)("p",{children:"Creating synth..."})}class _{constructor(e){this.context=e,console.log("CREATE fly"),this.osc=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=function(e){var t;if(void 0!==e.type&&void 0!==e.waveform)throw Error("PolyblepOscillator error - only waveform or type can be defined in options");return{frequency:"number"==typeof e.frequency?e.frequency:440,waveform:"number"==typeof e.waveform?e.waveform:null!==(t=h(e.type))&&void 0!==t?t:1}}(t),a=new AudioWorkletNode(e,"PolyBLEPWorkletProcessor",{numberOfInputs:1,numberOfOutputs:1});for(let e of c){let t=a.parameters.get(e);a[e]=t;let s=r[e];t.setValueAtTime(s,0)}Object.defineProperty(a,"type",{get(){var e;return 0===(e=this.waveform.value)?"sine":1===e?"sawtooth":2===e?"square":3===e?"triangle":void 0},set(e){let t=h(e);void 0!==t&&this.waveform.setValueAtTime(t,0)}});let s=a.disconnect.bind(a);return a.disconnect=(e,t,r)=>(a.port.postMessage({type:"DISCONNECT"}),s(e,t,r)),a}(e),this.filter=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=function(e){if(void 0!==e.type&&void 0!==e.filterType)throw Error("PolyblepOscillator error - only filterType or type can be defined in options");return{frequency:"number"==typeof e.frequency?e.frequency:4e3,resonance:"number"==typeof e.resonance?e.resonance:.5,filterType:"number"==typeof e.filterType?e.filterType:v(e.type)||1}}(t),a=new AudioWorkletNode(e,"StateVariableFilterWorkletProcessor",{numberOfInputs:1,numberOfOutputs:1});for(let e of g){let t=a.parameters.get(e);a[e]=t;let s=r[e];t.setValueAtTime(s,0)}Object.defineProperty(a,"type",{get(){var e;return 1===(e=this.filterType.value)?"lowpass":2===e?"bandpass":3===e?"highpass":"bypass"},set(e){let t=v(e);this.filterType.setValueAtTime(t,0)}});let s=a.disconnect.bind(a);return a.disconnect=(e,t,r)=>(a.port.postMessage({type:"DISCONNECT"}),s(e,t,r)),a}(e,{type:"lowpass",frequency:5e3}),this.vca=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=new AudioWorkletNode(e,"AdsrWorkletProcessor",{numberOfInputs:1,numberOfOutputs:1,processorOptions:t});for(let e of u){let t=a.parameters.get(e),s=r[e];"number"==typeof s&&(t.value=s),a[e]=t}a.gateOn=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.currentTime;a.gate.setValueAtTime(1,t)},a.gateOff=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.currentTime;a.gate.setValueAtTime(0,t)};let s=a.disconnect.bind(a);return a.disconnect=(e,t,r)=>(a.port.postMessage({type:"DISCONNECT"}),s(e,t,r)),a}(e,{mode:"modulator"}),this.osc.connect(this.filter).connect(this.vca).connect(e.destination),console.log("ready")}}}},function(e){e.O(0,[231,971,23,744],function(){return e(e.s=7908)}),_N_E=e.O()}]);