export const PROCESSOR = `"use strict";(()=>{var x=Math.PI*2;function y(t,r,o){if(o>r)throw Error("endFreq must be less than startFreq");let a=1/t,n=!1,c=0,s=(o-r)*a,e=r,u=1;return{update(l,i){l===1?n||(n=!0,e=r):n=!1,i!==u&&(u=i,console.log("duration",i),s=(o-r)*i*a)},next(){let l=Math.sin(c*x);return e>o&&(e+=s),c+=e*a,c>=1&&(c-=1),l}}}function A(t,r){let o=!1,a=0;return{update(n){n===1?o||(o=!0,a=r):o=!1},next(){return a===0?0:(a--,1)}}}function k(t,r,o,a,n){let c=1/t,s=0,e=0,u=r*c,l=a*c;return{next(){let i=Math.sin(s*x),b=Math.sin(e*x);return s+=u,e+=l,s>=1&&(s-=1),e>=1&&(e-=1),i*o+b*n}}}function v(t){return{next(){return Math.random()*2-1}}}function d(t,r,o){let a=0,n=0,c=0,s=0,e=0,u=0,l=0,i=0,b=1/o,f=.5/t,m=2*Math.PI;return{update(p){n=2*Math.tan(m*f*p),a=1/(1+b*n+n*n),c=n+b},process(p){return l=(p-c*s-e)*a,i=n*l+s,u=n*i+e,s=n*l+i,e=n*i+u,r===0?u:r===1?l:r===2?i:p}}}function h(t,r,o){let e=!1,u=r,l=o,i=Math.exp(-1/(u*t)),b=Math.exp(-1/(l*t)),f=0,m=0;return{update(p,M,g){p===1?e||(e=!0,f=1):e=!1,M!==u&&(u=M,i=Math.exp(-1/(Math.max(u,.01)*t))),g!==l&&(l=g,b=Math.exp(-1/(Math.max(l,.01)*t)))},next(){let p=0;switch(f){case 1:p=i*m+(1-i),p-m<=5e-8&&(f=2),m=p;break;case 2:p=b*m,m=p,p<=5e-8&&(f=0);break;case 0:default:p=0;break}return p}}}var D=t=>{let r=y(t,90,48),o=A(t,1),a=h(t,.1,.1),n=d(t,0,1),c=Math.tanh;return(s,e)=>{r.update(e.gate[0],e.decay[0]*.5),a.update(e.gate[0],e.attack[0],e.decay[0]),n.update(200+200*e.tone[0]);for(let u=0;u<s.length;u++)s[u]=c(n.process(r.next()*a.next()+o.next()))}},O=t=>{let r=v(t),o=h(t,.1,.1),a=k(t,238,1,476,1),n=h(t,.01,.1),c=d(t,0,1);return(s,e)=>{o.update(e.gate[0],e.attack[0],e.decay[0]),n.update(e.gate[0],.01,e.snap[0]),c.update(200+200*e.tone[0]);for(let u=0;u<s.length;u++)s[u]=c.process(r.next()*o.next()+a.next()*n.next())}};function C(t){switch(t){case"kick":return D(sampleRate);case"snare":return O(sampleRate);default:throw new Error("Invalid instrument: "+t)}}var E=class extends AudioWorkletProcessor{r;g;constructor(r){super(),this.r=!0;let o=r?.processorOptions?.type??"";this.g=C(o),this.port.onmessage=a=>{switch(a.data.type){case"DISCONNECT":this.r=!1;break}}}process(r,o,a){return this.g(o[0][0],a),this.r}static get parameterDescriptors(){return[["gate",0,0,1],["attack",.01,0,2],["decay",.5,0,10],["level",.8,0,1],["snap",.2,0,1],["tone",.2,0,1]].map(([a,n,c,s])=>({name:a,defaultValue:n,minValue:c,maxValue:s,automationRate:"k-rate"}))}};registerProcessor("Drum8WorkletProcessor",E);})();`;
