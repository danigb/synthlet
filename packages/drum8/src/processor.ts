export const PROCESSOR = `"use strict";(()=>{var x=Math.PI*2;function y(t,r,a){if(a>r)throw Error("endFreq must be less than startFreq");let o=1/t,n=!1,c=0,s=(a-r)*o,e=r,u=1;return{update(i,l){i===1?n||(n=!0,e=r):n=!1,l!==u&&(u=l,s=(a-r)*l*o)},next(){let i=Math.sin(c*x);return e>a&&(e+=s),c+=e*o,c>=1&&(c-=1),i}}}function A(t,r){let a=!1,o=0;return{update(n){n===1?a||(a=!0,o=r):a=!1},next(){return o===0?0:(o--,1)}}}function k(t,r,a,o,n){let c=1/t,s=0,e=0,u=r*c,i=o*c;return{next(){let l=Math.sin(s*x),b=Math.sin(e*x);return s+=u,e+=i,s>=1&&(s-=1),e>=1&&(e-=1),l*a+b*n}}}function v(t){return{next(){return Math.random()*2-1}}}function d(t,r,a){let o=0,n=0,c=0,s=0,e=0,u=0,i=0,l=0,b=1/a,f=.5/t,m=2*Math.PI;return{update(p){n=2*Math.tan(m*f*p),o=1/(1+b*n+n*n),c=n+b},process(p){return i=(p-c*s-e)*o,l=n*i+s,u=n*l+e,s=n*i+l,e=n*l+u,r===0?u:r===1?i:r===2?l:p}}}function h(t,r,a){let e=!1,u=r,i=a,l=Math.exp(-1/(u*t)),b=Math.exp(-1/(i*t)),f=0,m=0;return{update(p,M,g){p===1?e||(e=!0,f=1):e=!1,M!==u&&(u=M,l=Math.exp(-1/(Math.max(u,.01)*t))),g!==i&&(i=g,b=Math.exp(-1/(Math.max(i,.01)*t)))},next(){let p=0;switch(f){case 1:p=l*m+(1-l),p-m<=5e-8&&(f=2),m=p;break;case 2:p=b*m,m=p,p<=5e-8&&(f=0);break;case 0:default:p=0;break}return p}}}var D=t=>{let r=y(t,90,48),a=A(t,1),o=h(t,.1,.1),n=d(t,0,1),c=Math.tanh;return(s,e)=>{r.update(e.gate[0],e.decay[0]*.5),o.update(e.gate[0],e.attack[0],e.decay[0]),n.update(200+200*e.tone[0]);for(let u=0;u<s.length;u++)s[u]=c(n.process(r.next()*o.next()+a.next()))}},O=t=>{let r=v(t),a=h(t,.1,.1),o=k(t,238,1,476,1),n=h(t,.01,.1),c=d(t,0,1);return(s,e)=>{a.update(e.gate[0],e.attack[0],e.decay[0]),n.update(e.gate[0],.01,e.snap[0]),c.update(500+500*e.tone[0]);for(let u=0;u<s.length;u++)s[u]=c.process(r.next()*a.next()+o.next()*n.next())}};function C(t){switch(t){case"kick":return D(sampleRate);case"snare":return O(sampleRate);default:throw new Error("Invalid instrument: "+t)}}var E=class extends AudioWorkletProcessor{r;g;constructor(r){super(),this.r=!0;let a=r?.processorOptions?.type??"";this.g=C(a),this.port.onmessage=o=>{switch(o.data.type){case"DISCONNECT":this.r=!1;break}}}process(r,a,o){return this.g(a[0][0],o),this.r}static get parameterDescriptors(){return[["gate",0,0,1],["attack",.01,0,2],["decay",.5,0,10],["level",.8,0,1],["snap",.2,0,1],["tone",.2,0,1]].map(([o,n,c,s])=>({name:o,defaultValue:n,minValue:c,maxValue:s,automationRate:"k-rate"}))}};registerProcessor("Drum8WorkletProcessor",E);})();`;
