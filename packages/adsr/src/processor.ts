export const PROCESSOR = `"use strict";(()=>{function R(){let u=!1;return r=>{if(u===!1&&r>=.9)return u=!0,!0;if(u===!0&&r<.1)return u=!1,!1}}function P(u){let r=Math.exp(-1.5),n=Math.exp(-4.95),c=0,a=0,l=0,i=0,k=0,D=1,p={b:0,c:0},m={b:0,c:0},A={b:0,c:0},x=R(),b=0,e=0;return I(.01,.1,.5,.3),function(s,f,o,y){F(y);for(let g=0;g<o.length;g++){switch(b){case 1:e=p.b+e*p.c,(e>=1||c<=0)&&(e=1,b=2);break;case 2:e=m.b+e*m.c,(e<=i||a<=0)&&(e=i,b=3);break;case 3:e=i;break;case 4:e=A.b+e*A.c,(e<=0||l<=0)&&(e=0,b=0)}o[g]=(s?f[0]*e:e)*D+k}};function F(t){k=t.offset[0],D=t.gain[0],I(t.attack[0],t.decay[0],t.sustain[0],t.release[0]);let s=x(t.gate[0]);s===!0?b=1:s===!1&&(b=4)}function I(t,s,f,o){i!==f&&(i=f,a=s,d(m,a,i,n)),c!==t&&(c=t,d(p,c,1+2*r,r)),a!==s&&(a=s,d(m,a,i,n)),l!==o&&(l=o,d(A,l,0,n))}function d(t,s,f,o){let y=s*u;t.c=Math.exp(-Math.log((1+o)/o)/y),t.b=(f-o)*(1-t.c)}}var h=class extends AudioWorkletProcessor{p;r=!0;m;constructor(r){super(),this.m=r.processorOptions.mode==="modulator",console.log("AdsrWorkletProcessor",r,this.m),this.p=P(sampleRate),this.port.onmessage=n=>{switch(n.data.type){case"DISPOSE":this.r=!1;break}}}process(r,n,c){let a=n[0][0],l=r[0][0];return this.p(this.m,l,a,c),this.r}static get parameterDescriptors(){return[["gate",0,0,1],["attack",.01,0,10],["decay",.1,0,10],["sustain",.5,0,1],["release",.3,0,100],["offset",0,0,2e4],["gain",1,-2e4,2e4]].map(([r,n,c,a])=>({name:r,defaultValue:n,minValue:c,maxValue:a,automationRate:"k-rate"}))}};registerProcessor("AdsrWorkletProcessor",h);})();`;
