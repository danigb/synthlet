export const PROCESSOR = `(()=>{function C(i){return Object.keys(i).map(e=>{let{min:t,max:s,init:r}=i[e];return{name:e,minValue:t,maxValue:s,defaultValue:r,automationRate:"k-rate"}})}var l={gate:{min:0,max:1,init:0},attack:{min:0,max:10,init:.01},decay:{min:0,max:10,init:.1},sustain:{min:0,max:1,init:.5},release:{min:0,max:10,init:.3}},f=class{constructor(e){this.sampleRate=e;this.state=0,this.open=!1,this.output=0,this.attackTime=0,this.decayTime=0,this.releaseTime=0,this.attackCoef=0,this.attackTCO=Math.exp(-1.5),this.decayTCO=Math.exp(-4.95),this.releaseTCO=this.decayTCO,this.setParams(0,l.attack.init,l.decay.init,l.sustain.init,l.release.init)}setGate(e){let t=!!e;this.open!==t&&(this.open=t,t?this.state=1:this.state!==0&&(this.state=4))}setParams(e,t,s,r,n){this.setGate(e),this.setSustainLevel(r),this.setAttackTime(t),this.setDecayTime(s),this.setReleaseTime(n)}process(){switch(this.state){case 0:break;case 1:this.output=this.attackBase+this.output*this.attackCoef,(this.output>=1||this.attackTime<=0)&&(this.output=1,this.state=2);break;case 2:this.output=this.decayBase+this.output*this.decayCoef,(this.output<=this.sustainLevel||this.decayTime<=0)&&(this.output=this.sustainLevel,this.state=3);break;case 3:this.output=this.sustainLevel;break;case 4:this.output=this.releaseBase+this.output*this.releaseCoef,(this.output<=0||this.releaseTime<=0)&&(this.output=0,this.state=0)}return this.output}setSustainLevel(e){this.sustainLevel!==e&&(this.sustainLevel=e,this.decayTime=-1)}setAttackTime(e){if(this.attackTime===e)return;this.attackTime=e;let t=this.sampleRate*e,s=this.attackTCO;this.attackCoef=Math.exp(-Math.log((1+s)/s)/t),this.attackBase=(1+s)*(1-this.attackCoef)}setDecayTime(e){if(this.decayTime===e)return;this.decayTime=e;let t=this.sampleRate*e,s=this.decayTCO;this.decayCoef=Math.exp(-Math.log((1+s)/s)/t),this.decayBase=(this.sustainLevel-s)*(1-this.decayCoef)}setReleaseTime(e){if(this.releaseTime===e)return;this.releaseTime=e;let t=this.sampleRate*e,s=this.releaseTCO;this.releaseCoef=Math.exp(-Math.log((1+s)/s)/t),this.releaseBase=-s*(1-this.releaseCoef)}};var d=Math.PI,B=2*d,R=d*d,c=1e-9,k=Math.max;var w=4/d,E=-4/R;var h=5/12,b=Math.pow(10,-1/h),F=1/(1-b),$=1/(1+h*Math.log10(1+b)),j=1/(1+-Math.pow(10,-1/h)),N=h*Math.log10(1+b),U=1/(-h*Math.log10(b)+N);function A(i,e,t){return Math.max(e,Math.min(t,i))}var y=class{constructor(){this.hi=!1}process(e,t=0,s=1){return this.hi=e>=1&&!this.hi,this.hi}};function v(i){let e=!1,t=!1,s=!1,r=new y,n=0,m=0,o=0,p=0,a=0;function u(T,O,M,g,D){e=T>=1,r.process(T)&&(t=!0,s=!0),o=g,n=A(1/(c+i*O),c,.5),m=k(-.5,(o-1)/(c+i*M)),p=k(-1,-(o+c)/(c+i*D))}function P(){return s?(e?t?(a+=n,a>=1&&(a=1,t=!1)):a<o+.001?a=o:a+=m:(a+=p,a<=p&&(s=!1)),a):0}return{setParams:u,process:P}}var S={gate:{min:0,max:1,init:0},attack:{min:0,max:10,init:.01},decay:{min:0,max:10,init:.1},sustain:{min:0,max:1,init:.5},release:{min:0,max:10,init:.3}},L=C(S),x=class extends AudioWorkletProcessor{constructor(t){super();this.#e(t?.processorOptions?.type==="linear"?"linear":"exp"),this.port.onmessage=s=>{let r=s.data?.type==="linear"?"linear":"exp";this.t!==r&&this.#e(r)}}#e(t){this.t=t,this.p=t==="linear"?v(sampleRate):new f(sampleRate),this.p.setParams(0,.01,.1,.5,.3)}process(t,s,r){this.p.setParams(r.gate[0],r.attack[0],r.decay[0],r.sustain[0],r.release[0]);let n=t[0],m=s[0],o=Math.min(n.length,m.length);if(o===0)return!0;let p=n[0].length;for(let a=0;a<p;a++)for(let u=0;u<o;u++)m[u][a]=n[u][a]*this.p.process();return!0}static get parameterDescriptors(){return L}};registerProcessor("AdsrWorklet",x);})();`;
