export const PROCESSOR = `(()=>{var i={gate:{min:0,max:1,defaultValue:0},attack:{min:0,max:10,defaultValue:.1},decay:{min:0,max:10,defaultValue:.1},sustain:{min:0,max:1,defaultValue:.5},release:{min:0,max:10,defaultValue:.3}},d=Object.keys(i).map(n=>{let{min:e,max:a,defaultValue:r}=i[n];return{name:n,min:e,max:a,defaultValue:r,automationRate:"k-rate"}}),u=class{constructor(e){this.sampleRate=e,this.attack=i.attack.defaultValue,this.decay=i.decay.defaultValue,this.sustain=i.sustain.defaultValue,this.release=i.release.defaultValue,this.timer=0,this.a=0,this.b=0,this.y=0,this.x=0,this.prev=0,this.mode=0}setCoefficients(e){this.a=Math.exp(-1/(e*this.sampleRate)),this.b=1-this.a}process(e,a,r){e!==0&&this.mode===0?(this.mode=1,this.timer=0,this.setCoefficients(.6*this.attack)):e===0&&(this.mode=3,this.setCoefficients(this.release)),this.x=e,this.prev=e;let o=a[0].length,m=Math.min(a.length,r.length);if(m)if(this.mode===0)for(let t=0;t<o;t++)for(let s=0;s<m;s++)r[s][t]=0;else for(let t=0;t<o;t++){this.y=this.b*this.x+this.a*this.y,this.y>.99&&this.mode===1&&(this.mode=2,this.setCoefficients(this.decay)),this.mode===3&&(this.x=this.x*this.sustain);for(let s=0;s<m;s++)r[s][t]=this.y*a[s][t]}}};var l=Object.keys(i).map(n=>{let{min:e,max:a,defaultValue:r}=i[n];return{name:n,minValue:e,maxValue:a,defaultValue:r,automationRate:"k-rate"}}),h=class extends AudioWorkletProcessor{constructor(){super();this.adsr=new u(sampleRate)}process(a,r,o){let m=o.gate[0],t=a[0],s=r[0];return Math.min(t.length,s.length)===0||this.adsr.process(m,t,s),!0}static get parameterDescriptors(){return l}};registerProcessor("AdsrWorklet",h);})();`;
